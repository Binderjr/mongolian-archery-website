<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Өвлийн хувцасны их дэлгүүр — Store</title>
    <meta name="description" content="Өвлийн хувцасны дэлгүүр — бүтээгдэхүүний каталог болон багц." />
    <style>
        :root{
            --accent:#0b6efd;
            --bg:#f7f8fb;
            --card:#ffffff;
            --muted:#6b7280;
            --radius:12px;
            --max-width:1100px;
        }
        *{box-sizing:border-box}
        body{
            margin:0;
            font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
            background:linear-gradient(180deg,var(--bg),#eef2f7 60%);
            color:#111827;
            -webkit-font-smoothing:antialiased;
            -moz-osx-font-smoothing:grayscale;
            padding:24px;
            display:flex;
            justify-content:center;
            min-height:100vh;
        }
        .container{
            width:100%;
            max-width:var(--max-width);
        }
        header{
            display:flex;
            align-items:center;
            justify-content:space-between;
            gap:16px;
            margin-bottom:20px;
        }
        .brand{
            display:flex;
            gap:12px;
            align-items:center;
        }
        .logo{
            width:52px;
            height:52px;
            background:linear-gradient(135deg,var(--accent),#6d28d9);
            border-radius:10px;
            display:flex;
            align-items:center;
            justify-content:center;
            color:white;
            font-weight:700;
            font-size:18px;
            box-shadow:0 6px 18px rgba(11,110,253,0.12);
        }
        h1{font-size:20px;margin:0}
        p.lead{margin:0;color:var(--muted);font-size:14px}
        .actions{display:flex;align-items:center;gap:12px}
        .search{
            background:var(--card);
            border-radius:999px;
            padding:8px 12px;
            display:flex;
            align-items:center;
            gap:8px;
            box-shadow:0 6px 20px rgba(15,23,42,0.06);
        }
        .search input{
            border:0;outline:none;background:transparent;width:220px;font-size:14px;
        }
        .btn{
            background:var(--accent);
            color:#fff;padding:10px 14px;border-radius:10px;border:0;cursor:pointer;font-weight:600;
            box-shadow:0 6px 18px rgba(11,110,253,0.12);
        }
        .catalog{
            display:grid;
            grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
            gap:18px;
            margin-top:18px;
        }
        .card{
            background:var(--card);
            border-radius:12px;
            overflow:hidden;
            box-shadow:0 8px 30px rgba(2,6,23,0.06);
            display:flex;
            flex-direction:column;
            min-height:320px;
        }
        .card img{
            width:100%;height:260px;object-fit:cover;
            background:#e6eefb;
        }
        .card .body{
            padding:12px 14px 16px;
            flex:1;
            display:flex;
            flex-direction:column;
            gap:8px;
        }
        .meta{display:flex;justify-content:space-between;align-items:center}
        .price{font-weight:700;color:#0f172a}
        .desc{color:var(--muted);font-size:13px;margin:0}
        .card .actions{
            padding:12px 14px;
            display:flex;
            gap:8px;
            align-items:center;
        }
        .btn-outline{
            border:1px solid #e6edf8;background:transparent;padding:8px 12px;border-radius:10px;cursor:pointer;color:var(--accent);
        }
        /* cart sidebar */
        .cart-toggle{
            background:#fff;border-radius:10px;padding:8px 10px;display:flex;gap:8px;align-items:center;border:1px solid rgba(15,23,42,0.06);
        }
        .cart-count{
            background:#ef4444;color:white;padding:4px 8px;border-radius:999px;font-size:12px;font-weight:700;
        }
        .sidebar{
            position:fixed;
            right:18px;
            top:80px;
            width:360px;
            max-width:calc(100% - 36px);
            background:var(--card);
            border-radius:14px;
            box-shadow:0 20px 60px rgba(2,6,23,0.12);
            overflow:hidden;
            transform:translateY(-10px) scale(.98);
            opacity:0;
            transition:all .22s ease;
            pointer-events:none;
        }
        .sidebar.open{transform:none;opacity:1;pointer-events:auto}
        .sidebar header{
            display:flex;align-items:center;justify-content:space-between;padding:14px 16px;border-bottom:1px solid #f1f5f9;
        }
        .cart-list{max-height:320px;overflow:auto;padding:12px 14px;display:flex;flex-direction:column;gap:10px}
        .cart-item{display:flex;gap:10px;align-items:center}
        .cart-item img{width:64px;height:64px;object-fit:cover;border-radius:8px}
        .cart-item .info{flex:1}
        .qty{
            display:flex;gap:6px;align-items:center;background:#f3f4f6;padding:6px;border-radius:8px;
        }
        .cart-footer{padding:12px 16px;border-top:1px solid #f1f5f9}
        .summary{display:flex;justify-content:space-between;color:var(--muted);margin-bottom:8px;font-size:14px}
        .checkout-btn{width:100%;padding:10px 12px;border-radius:10px;border:0;background:#10b981;color:white;font-weight:700;cursor:pointer}
        /* checkout modal */
        .modal{
            position:fixed;inset:0;display:grid;place-items:center;padding:20px;background:rgba(2,6,23,0.45);opacity:0;pointer-events:none;transition:opacity .15s ease;
        }
        .modal.open{opacity:1;pointer-events:auto}
        .modal .dialog{background:var(--card);border-radius:12px;max-width:820px;width:100%;overflow:hidden;display:grid;grid-template-columns:1fr 360px}
        .checkout-form{padding:18px;display:flex;flex-direction:column;gap:12px}
        label{font-size:13px;color:var(--muted)}
        input[type="text"],input[type="email"],select,textarea{
            padding:10px;border-radius:8px;border:1px solid #e6eefb;background:#fff;
            font-size:14px;width:100%;
        }
        .order-side{background:#f8fafc;padding:16px}
        .small{font-size:13px;color:var(--muted)}
        .muted{color:var(--muted)}
        footer{margin-top:28px;text-align:center;color:var(--muted);font-size:13px}
        @media (max-width:800px){
            .modal .dialog{grid-template-columns:1fr}
            .sidebar{right:12px;left:12px;top:auto;bottom:12px;width:auto}
            .card img{height:220px}
        }
    </style>
</head>
<body>
    <div class="container" role="main">
        <header>
            <div class="brand">
                <div class="logo">MO</div>
                <div>
                    <h1>Өвлийн өмдний захиалга</h1>
                    <p class="lead">Дулаан явбал мянган лан</p>
                </div>
            </div>

            <div class="actions" aria-hidden="false">
                <div class="search" role="search">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M21 21l-4.35-4.35" stroke="#0f172a" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/><circle cx="11" cy="11" r="6" stroke="#0f172a" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    <input id="search" placeholder="Юу хайж байна түүнийгээ бич. Жич: хар өмд" />
                </div>

                <button class="cart-toggle" id="openCart" aria-label="Open cart">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M6 6h15l-1.5 9h-12L4 3H2" stroke="#0f172a" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    <span class="small muted">Cart</span>
                    <span class="cart-count" id="cartCount">0</span>
                </button>
            </div>
        </header>

        <main>
            <section class="catalog" id="catalog" aria-live="polite"></section>

            <footer>
                Sample dropshipping storefront — no payments processed. Demo only.
            </footer>
        </main>
    </div>

    <!-- cart sidebar -->
    <aside class="sidebar" id="cartSidebar" aria-hidden="true" aria-label="Shopping cart">
        <header>
            <div>
                <strong>Your Cart</strong>
                <div class="small muted" id="cartItemsCount">0 items</div>
            </div>
            <div style="display:flex;gap:8px;align-items:center">
                <button class="btn-outline" id="clearCart">Clear</button>
                <button class="btn" id="checkoutOpen">Checkout</button>
            </div>
        </header>

        <div class="cart-list" id="cartList">
            <!-- items -->
        </div>

        <div class="cart-footer">
            <div class="summary"><span>Subtotal</span><span id="subtotal">₮0.00</span></div>
            <div class="summary"><span>Shipping</span><span id="shipping">₮0.00</span></div>
            <div class="summary" style="font-weight:700"><span>Total</span><span id="total">₮0.00</span></div>
        </div>
    </aside>

    <!-- checkout modal -->
    <div class="modal" id="checkoutModal" aria-hidden="true">
        <div class="dialog" role="dialog" aria-modal="true" aria-label="Checkout form">
            <form class="checkout-form" id="checkoutForm">
                <h2 style="margin:0">Checkout</h2>
                <p class="small muted">Fill shipping details. This demo does not process payments.</p>

                <div>
                    <label for="fullName">Full name</label>
                    <input id="fullName" name="fullName" type="text" required />
                </div>

                <div style="display:flex;gap:8px">
                    <div style="flex:1">
                        <label for="email">Email</label>
                        <input id="email" name="email" type="email" required />
                    </div>
                    <div style="width:120px">
                        <label for="phone">Phone</label>
                        <input id="phone" name="phone" type="text" />
                    </div>
                </div>

                <div>
                    <label for="address">Shipping address</label>
                    <input id="address" name="address" type="text" required />
                </div>

                <div style="display:flex;gap:8px">
                    <div style="flex:1">
                        <label for="city">City</label>
                        <input id="city" name="city" type="text" required />
                    </div>
                    <div style="width:120px">
                        <label for="zip">ZIP</label>
                        <input id="zip" name="zip" type="text" required />
                    </div>
                </div>

                <div>
                    <label for="shippingMethod">Shipping method</label>
                    <select id="shippingMethod" name="shippingMethod">
                        <option value="standard">Энгийн — 7,000₮ (3-7 хоног)</option>
                        <option value="express">Түргэн — 20,000₮ (1-2 хоног)</option>
                    </select>
                </div>

                <div style="display:flex;gap:8px">
                    <button type="submit" class="checkout-btn">Place order</button>
                    <button type="button" id="closeModal" class="btn-outline">Cancel</button>
                </div>
            </form>

            <aside class="order-side">
                <h3 style="margin-top:0">Order summary</h3>
                <div id="orderItems" style="display:flex;flex-direction:column;gap:8px;margin-bottom:10px"></div>
                <div class="summary"><span>Subtotal</span><span id="oSubtotal">₮0.00</span></div>
                <div class="summary"><span>Shipping</span><span id="oShipping">₮0.00</span></div>
                <div class="summary"><span>Tax (8%)</span><span id="oTax">₮0.00</span></div>
                <hr />
                <div class="summary" style="font-weight:800;font-size:16px"><span>Total</span><span id="oTotal">₮0.00</span></div>
                <p class="small muted" style="margin-top:8px">Orders are forwarded to suppliers automatically. This demo does not charge cards.</p>
            </aside>
        </div>
    </div>

    <script>
        // Products catalog
        const products = [
            {
                id: 'wp-1',
                name: 'Сибер дулаан өмд',
                price: 7999,
                desc: 'Heavy insulation, windproof shell, ideal for extreme cold.',
                img: 'https://picsum.photos/seed/pant1/800/1000'
            },
            {
                id: 'wp-2',
                name: 'Канадын галуу',
                price: 4999,
                desc: 'Soft fleece lining for everyday warmth and comfort.',
                img: 'https://picsum.photos/seed/pant2/800/1000'
            },
            {
                id: 'wp-3',
                name: 'Амар задаргаатай өмд',
                price: 8999,
                desc: 'Fully waterproof, taped seams, great for wet snow.',
                img: 'https://picsum.photos/seed/pant3/800/1000'
            },
            {
                id: 'wp-4',
                name: 'Хөнгөн жинтэй дулаан өмд',
                price: 9999,
                desc: 'Packable down insulation — great for cold travel.',
                img: 'https://picsum.photos/seed/pant4/800/1000'
            },
            {
                id: 'wp-5',
                name: 'Орос өвлийн малгай',
                price: 6999,
                desc: 'Breathable panels and reinforced knees for skiing.',
                img: 'https://picsum.photos/seed/pant5/800/1000'
            },
            {
                id: 'wp-6',
                name: 'Өвлийн ажлын өмд',
                price: 6499,
                desc: 'Durable fabric for outdoor work and tough conditions.',
                img: 'https://picsum.photos/seed/pant6/800/1000'
            }
        ];

        // Simple cart stored in localStorage
        const CART_KEY = 'winterpants_cart_v1';
        let cart = JSON.parse(localStorage.getItem(CART_KEY) || '{}');

        // DOM refs
        const catalog = document.getElementById('catalog');
        const cartCount = document.getElementById('cartCount');
        const cartSidebar = document.getElementById('cartSidebar');
        const cartList = document.getElementById('cartList');
        const cartItemsCount = document.getElementById('cartItemsCount');
        const subtotalEl = document.getElementById('subtotal');
        const shippingEl = document.getElementById('shipping');
        const totalEl = document.getElementById('total');
        const openCartBtn = document.getElementById('openCart');
        const checkoutOpenBtn = document.getElementById('checkoutOpen');
        const clearCartBtn = document.getElementById('clearCart');
        const checkoutModal = document.getElementById('checkoutModal');
        const checkoutForm = document.getElementById('checkoutForm');
        const closeModalBtn = document.getElementById('closeModal');
        const orderItems = document.getElementById('orderItems');
        const oSubtotal = document.getElementById('oSubtotal');
        const oShipping = document.getElementById('oShipping');
        const oTax = document.getElementById('oTax');
        const oTotal = document.getElementById('oTotal');
        const shippingMethodSelect = document.getElementById('shippingMethod');
        const searchInput = document.getElementById('search');

        // Utilities
        const fmt = n => n.toString().replace(/\B(?=(\d{3})+(?!\d))/g, "’") + '₮';

        function saveCart(){
            localStorage.setItem(CART_KEY, JSON.stringify(cart));
            renderCart();
        }

        function addToCart(id, qty = 1){
            if(!cart[id]) cart[id] = { id, qty };
            else cart[id].qty += qty;
            saveCart();
            flashCart();
        }

        function removeFromCart(id){
            delete cart[id];
            saveCart();
        }

        function updateQty(id, qty){
            if(qty <= 0) removeFromCart(id);
            else cart[id].qty = qty;
            saveCart();
        }

        function clearCart(){
            cart = {};
            saveCart();
        }

        function cartItemsArray(){
            return Object.values(cart).map(ci => {
                const p = products.find(x => x.id === ci.id);
                return { ...p, qty: ci.qty };
            });
        }

        function computeTotals(shippingMethod = 'standard') {
            const items = cartItemsArray();
            const subtotal = items.reduce((s, i) => s + i.price * i.qty, 0);
            let shipping = 0;
            if (Object.keys(cart).length > 0) {
                shipping = shippingMethod === 'express' ? 20000 : (subtotal >= 150000 ? 0 : 7000);
            }
            const tax = subtotal * 0.08; // 8% VAT equivalent
            const total = subtotal + shipping + tax;
            return { subtotal, shipping, tax, total };
        }

        // Render product cards
        function renderCatalog(filter = ''){
            catalog.innerHTML = '';
            const q = filter.trim().toLowerCase();
            const items = products.filter(p => p.name.toLowerCase().includes(q) || p.desc.toLowerCase().includes(q));
            items.forEach(p => {
                const card = document.createElement('article');
                card.className = 'card';
                card.innerHTML = `
                    <img loading="lazy" src="${p.img}" alt="${escapeHtml(p.name)}">
                    <div class="body">
                        <div class="meta">
                            <div>
                                <div style="font-weight:700">${escapeHtml(p.name)}</div>
                                <div class="small muted">${escapeHtml(p.desc)}</div>
                            </div>
                            <div class="price">${fmt(p.price)}</div>
                        </div>
                        <p class="desc muted">Sizes: S, M, L, XL • Colors vary</p>
                    </div>
                    <div class="actions">
                        <button class="btn-outline" data-id="${p.id}" aria-label="View ${escapeHtml(p.name)}">View</button>
                        <button class="btn" data-add="${p.id}">Add to cart</button>
                    </div>
                `;
                catalog.appendChild(card);
            });
        }

        // Minimal escape to avoid injection in alt/text
        function escapeHtml(s){ return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

        // Render cart sidebar
        function renderCart(){
            const items = cartItemsArray();
            cartCount.textContent = items.reduce((s,i)=> s + i.qty, 0);
            cartItemsCount.textContent = items.reduce((s,i)=> s + i.qty, 0) + ' items';
            cartList.innerHTML = '';
            if(items.length === 0){
                cartList.innerHTML = '<div class="small muted" style="padding:8px">Your cart is empty.</div>';
            } else {
                items.forEach(i => {
                    const el = document.createElement('div');
                    el.className = 'cart-item';
                    el.innerHTML = `
                        <img src="${i.img}" alt="${escapeHtml(i.name)}" />
                        <div class="info">
                            <div style="font-weight:700">${escapeHtml(i.name)}</div>
                            <div class="small muted">${fmt(i.price)} • ${i.qty} ×</div>
                            <div style="margin-top:6px;display:flex;gap:8px;align-items:center">
                                <div class="qty">
                                    <button data-dec="${i.id}" aria-label="Decrease">-</button>
                                    <div style="min-width:28px;text-align:center;font-weight:700">${i.qty}</div>
                                    <button data-inc="${i.id}" aria-label="Increase">+</button>
                                </div>
                                <button class="btn-outline" data-remove="${i.id}">Remove</button>
                            </div>
                        </div>
                        <div style="font-weight:700">${fmt(i.price * i.qty)}</div>
                    `;
                    cartList.appendChild(el);
                });
            }

            // totals
            const shipMethod = shippingMethodSelect ? shippingMethodSelect.value : 'standard';
            const t = computeTotals(shipMethod);
            subtotalEl.textContent = fmt(t.subtotal);
            shippingEl.textContent = fmt(t.shipping);
            totalEl.textContent = fmt(t.total);
        }

        // Flash cart button
        function flashCart(){
            openCartBtn.animate([{ transform:'translateY(0)' },{ transform:'translateY(-6px)' },{ transform:'translateY(0)' }], { duration:300 });
        }

        // Event listeners
        document.addEventListener('click', (e) => {
            const add = e.target.closest('[data-add]');
            if(add){
                addToCart(add.getAttribute('data-add'), 1);
                return;
            }
            const view = e.target.closest('[data-id]');
            if(view && !view.hasAttribute('data-add')) {
                // quick focus on image modal behavior omitted for brevity
                alert('Product quick view is demo-only. Use Add to cart to purchase.');
                return;
            }
            const dec = e.target.closest('[data-dec]');
            if(dec){
                const id = dec.getAttribute('data-dec'), current = cart[id] ? cart[id].qty : 0;
                updateQty(id, current - 1);
                return;
            }
            const inc = e.target.closest('[data-inc]');
            if(inc){
                const id = inc.getAttribute('data-inc'), current = cart[id] ? cart[id].qty : 0;
                updateQty(id, current + 1);
                return;
            }
            const rem = e.target.closest('[data-remove]');
            if(rem){
                removeFromCart(rem.getAttribute('data-remove'));
                return;
            }
        });

        openCartBtn.addEventListener('click', () => {
            cartSidebar.classList.toggle('open');
            cartSidebar.setAttribute('aria-hidden', cartSidebar.classList.contains('open') ? 'false' : 'true');
        });

        clearCartBtn.addEventListener('click', () => {
            if(confirm('Clear cart?')) clearCart();
        });

        checkoutOpenBtn.addEventListener('click', () => {
            if(Object.keys(cart).length === 0){
                alert('Your cart is empty.');
                return;
            }
            openCheckout();
        });

        function openCheckout(){
            // populate order side
            const items = cartItemsArray();
            orderItems.innerHTML = '';
            items.forEach(i => {
                const d = document.createElement('div');
                d.style.display = 'flex';
                d.style.justifyContent = 'space-between';
                d.style.alignItems = 'center';
                d.innerHTML = `<div style="display:flex;gap:8px;align-items:center"><img src="${i.img}" alt="" style="width:44px;height:44px;border-radius:6px;object-fit:cover"/><div><div style="font-weight:700">${escapeHtml(i.name)}</div><div class="small muted">${i.qty} × ${fmt(i.price)}</div></div></div><div style="font-weight:700">${fmt(i.price * i.qty)}</div>`;
                orderItems.appendChild(d);
            });
            const t = computeTotals(shippingMethodSelect.value);
            oSubtotal.textContent = fmt(t.subtotal);
            oShipping.textContent = fmt(t.shipping);
            oTax.textContent = fmt(t.tax);
            oTotal.textContent = fmt(t.total);

            checkoutModal.classList.add('open');
            checkoutModal.setAttribute('aria-hidden','false');
        }

        closeModalBtn.addEventListener('click', () => {
            checkoutModal.classList.remove('open');
            checkoutModal.setAttribute('aria-hidden','true');
        });

        shippingMethodSelect.addEventListener('change', () => {
            renderCart();
            const t = computeTotals(shippingMethodSelect.value);
            oShipping.textContent = fmt(t.shipping);
            oSubtotal.textContent = fmt(t.subtotal);
            oTax.textContent = fmt(t.tax);
            oTotal.textContent = fmt(t.total);
        });

        checkoutForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const formData = new FormData(checkoutForm);
            const data = Object.fromEntries(formData.entries());
            // Basic validation
            if(!data.fullName || !data.email || !data.address) {
                alert('Please complete required fields.');
                return;
            }
            // Build fake order payload
            const items = cartItemsArray();
            const totals = computeTotals(data.shippingMethod || 'standard');

            const order = {
                id: 'ORD-' + Date.now(),
                customer: {
                    name: data.fullName, email: data.email, phone: data.phone || '', address: data.address, city: data.city || '', zip: data.zip || ''
                },
                items: items.map(i => ({ id: i.id, name: i.name, qty: i.qty, price: i.price })),
                shipping: data.shippingMethod,
                totals
            };

            // Demo: show confirmation and clear cart
            alert('Order placed (demo): ' + order.id + '\\nTotal: ' + fmt(order.totals.total));
            clearCart();
            checkoutModal.classList.remove('open');
            checkoutModal.setAttribute('aria-hidden','true');
            checkoutForm.reset();
        });

        // search
        searchInput.addEventListener('input', (e) => {
            renderCatalog(e.target.value);
        });

        // initial render
        renderCatalog('');
        renderCart();

        // hydrate cart from example (optional demo add)
        if (Object.keys(cart).length === 0) {
            // prefill demonstration product for easier testing (comment out if undesired)
            // addToCart(products[0].id, 1);
        }
    </script>
</body>
</html>
